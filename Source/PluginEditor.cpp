/*
  ==============================================================================

    This file was auto-generated by the Introjucer!

    It contains the basic startup code for a Juce application.

  ==============================================================================
*/

#include "PluginProcessor.h"
#include "PluginEditor.h"


//==============================================================================
KissOfShameAudioProcessorEditor::KissOfShameAudioProcessorEditor (KissOfShameAudioProcessor* ownerFilter)
    : AudioProcessorEditor (ownerFilter)
{

    String imageLocation = "/Users/brianhansen/Documents/Brian/Work/1_KOS/kissofshame/GUI_Resources/Face/Controls.png";
    faceImage = ImageCache::getFromFile(File(imageLocation));
    faceImage = faceImage.rescaled(faceImage.getWidth()*0.75, faceImage.getHeight()*0.75);
    setSize(faceImage.getWidth(), faceImage.getHeight());

    inputSaturationKnob = new CustomKnob;
    inputSaturationKnob->setTopLeftPosition(50, 100);
    inputSaturationKnob->addListener (this);
    addAndMakeVisible(inputSaturationKnob);
    
    shameKnob = new CustomKnob;
    shameKnob->setTopLeftPosition(inputSaturationKnob->getRight() + 10, 100);
    shameKnob->addListener (this);
    addAndMakeVisible(shameKnob);

    hissKnob = new CustomKnob;
    hissKnob->setTopLeftPosition(shameKnob->getRight() + 10, 100);
    hissKnob->addListener (this);
    addAndMakeVisible(hissKnob);
    
    blendKnob = new CustomKnob;
    blendKnob->setTopLeftPosition(hissKnob->getRight() + 10, 100);
    blendKnob->addListener (this);
    addAndMakeVisible(blendKnob);
    
    outputKnob = new CustomKnob;
    outputKnob->setTopLeftPosition(blendKnob->getRight() + 10, 100);
    outputKnob->addListener (this);
    addAndMakeVisible(outputKnob);

    bypassButton = new CustomButton;
    bypassButton->setTopLeftPosition(outputKnob->getRight() + 10, 100);
    bypassButton->addListener(this);
    bypassButton->setClickingTogglesState(true);
    addAndMakeVisible(bypassButton);
    
    
    //*** Need to add a label for the slider ***
    //    gainLabel.attachToComponent (&gainSlider, false);
    //    gainLabel.setFont (Font (11.0f));
    
    
    //NOTE: basic animation of an image. 
//    String animatedImagePath = "/Users/brianhansen/Documents/Brian/Work/1_KOS/kissofshame/GUI_Resources/MixKnob/Knob-Pan-Mix.png";
//    File aniFile(animatedImagePath);
//    testAnimation = new ImageAnimator(aniFile, 128, 20);
//    addAndMakeVisible(testAnimation);
//    testAnimation->startAnimation();
    
    
    startTimer(200);
}

KissOfShameAudioProcessorEditor::~KissOfShameAudioProcessorEditor()
{
}

void KissOfShameAudioProcessorEditor::timerCallback()
{
    KissOfShameAudioProcessor* ourProcessor = getProcessor();
}

void KissOfShameAudioProcessorEditor::sliderValueChanged (Slider* slider)
{
    if (slider == inputSaturationKnob)
    {
        // It's vital to use setParameterNotifyingHost to change any parameters that are automatable
        // by the host, rather than just modifying them directly, otherwise the host won't know
        // that they've changed.
        getProcessor()->setParameterNotifyingHost (KissOfShameAudioProcessor::inputSaturationParam,
                                                   (float) inputSaturationKnob->getValue());
        
        getProcessor()->aGraph->setAudioUnitParameters(eSaturationDrive, (float) inputSaturationKnob->getValue());
    }
    else if(slider == shameKnob)
    {
        getProcessor()->setParameterNotifyingHost (KissOfShameAudioProcessor::shameParam,
                                                   (float) shameKnob->getValue());
        
        getProcessor()->aGraph->setAudioUnitParameters(eShameFreq, (float) shameKnob->getValue());
    }
    else if(slider == hissKnob)
    {
        getProcessor()->setParameterNotifyingHost (KissOfShameAudioProcessor::hissParam,
                                                   (float) hissKnob->getValue());
        
        getProcessor()->aGraph->setAudioUnitParameters(eHissLevel, (float) hissKnob->getValue());
    }
    else if(slider == blendKnob)
    {
        getProcessor()->setParameterNotifyingHost (KissOfShameAudioProcessor::blendParam,
                                                   (float) blendKnob->getValue());
        
        getProcessor()->aGraph->setAudioUnitParameters(eBlendLevel, (float) blendKnob->getValue());
    }
    else if(slider == outputKnob)
    {
        getProcessor()->setParameterNotifyingHost (KissOfShameAudioProcessor::outputParam,
                                                   (float) outputKnob->getValue());
        
        getProcessor()->aGraph->setAudioUnitParameters(eOutputLevel, (float) outputKnob->getValue());
    }



}


void KissOfShameAudioProcessorEditor::buttonClicked (Button* b)
{
    if(b == bypassButton)
    {
        getProcessor()->setParameterNotifyingHost (KissOfShameAudioProcessor::bypassParam,
                                                   b->getToggleState());
        
        getProcessor()->aGraph->setAudioUnitParameters(eBypass, b->getToggleState());
    }
}


//==============================================================================
void KissOfShameAudioProcessorEditor::paint (Graphics& g)
{
    
    g.drawImageAt(faceImage, 0, 0);
    
//    String LabelText = "RAVEN SETTINGS";
//    g.setFont(35.0f);
//    g.setColour(Colours::grey);
//    g.drawFittedText(LabelText, 60, 10, 300, 50, 1, 1);
//    g.fillAll (Colours::white);
}
